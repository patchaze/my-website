---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CTABanner from '../../components/CTABanner.astro';
import countriesData from '../../data/countries.json';
import { Image } from 'astro:assets';

const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/images/**/*.{jpeg,jpg,png,gif}');

export async function getStaticPaths() {
  return countriesData.map(country => ({
    params: { slug: country.slug },
    props: { country },
  }));
}

const { country } = Astro.props;

const breadcrumb = [
  { name: 'Destinations', url: 'https://www.duriantravel.com/destinations/' },
  { name: country.name, url: `https://www.duriantravel.com/destinations/${country.slug}/` }
];
---

<BaseLayout
  title={`${country.name} Travel Guide & Visa Info - DURIAN`}
  description={`Plan your trip to ${country.name}. ${country.metaLine}. Discover the best cities to visit, average budget, and visa guidance for the Schengen area.`}
  breadcrumb={breadcrumb}
>
  <section class="hero-country-card">
    <div class="hero__bg-full">
      <Image src={images[`/src/assets${country.heroImage}`]()} alt={`Beautiful landscape of ${country.name}`} width={1920} loading="eager" />
      <div class="hero__overlay-dark"></div>
    </div>
    <div class="container hero-country-content">
      <div class="hero__badge">üìç {country.region.toUpperCase()}</div>
      <h1 class="hero__title">{country.name}</h1>
      <p class="hero__description">{country.metaLine}</p>
    </div>
  </section>

  <section class="section section--alt">
    <div class="container container--narrow">
      <div class="quick-facts-box">
        <h2 class="section-title">Quick Facts</h2>
        <ul class="facts-list">
          <li><strong>Capital:</strong> {country.facts.capital}</li>
          <li><strong>Currency:</strong> {country.facts.currency}</li>
          <li><strong>Language:</strong> {country.facts.language}</li>
          <li><strong>Timezone:</strong> {country.facts.timezone}</li>
          <li><strong>Best Months:</strong> {country.facts.bestMonths}</li>
          <li><strong>Daily Budget:</strong> {country.facts.dailyBudget}</li>
        </ul>
      </div>

      <div class="prose mt-8">
        <h2>Why Go?</h2>
        <p>{country.whyGo}</p>
      </div>
      
      <div class="prose mt-8">
        <h2>Visa Note</h2>
        <div class="visa-alert">
          <p><strong>{country.visaNote}</strong></p>
          <a href="/schengen-visa-guide/" class="btn btn--secondary mt-4">Visa Guidance ‚Üí</a>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <header class="section-header text-center">
        <h2 class="section-title">Top Cities</h2>
      </header>
      <div class="cities-grid">
        {country.cities.map(city => (
          <div class="city-card glass-card">
            <Image src={images[`/src/assets${city.image}`]()} alt={`City view of ${city.name}`} width={600} loading="lazy" />
            <div class="city-card__info">
              <h3>{city.name}</h3>
            </div>
          </div>
        ))}
      </div>
    </div>
    
    <div class="container text-center mt-12">
        <a href="/destinations/" class="btn btn--secondary">‚Üê Back to all Destinations</a>
    </div>
  </section>

  <CTABanner
    title={`Ready to plan your trip to ${country.name}?`}
    subtitle="Book a free 15-minute call. Let's design your perfect itinerary."
    cta="View Itinerary Ideas"
  />

</BaseLayout>

<style>
.hero-country-card {
  position: relative;
  min-height: 60vh;
  display: flex;
  align-items: center;
  color: white;
  overflow: hidden;
  padding-top: 80px;
}
.hero__bg-full {
  position: absolute;
  inset: 0;
  z-index: 0;
}
.hero__bg-full img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.hero__overlay-dark {
  position: absolute;
  inset: 0;
  background: linear-gradient(to right, rgba(15, 33, 56, 0.8) 0%, rgba(15, 33, 56, 0.4) 100%);
}
.hero-country-content {
  position: relative;
  z-index: 1;
}

.quick-facts-box {
  background: white;
  border-radius: var(--radius-lg);
  padding: var(--space-8);
  box-shadow: 0 10px 30px rgba(0,0,0,0.05);
  margin-top: -100px;
  position: relative;
  z-index: 10;
}

.facts-list {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-4);
  list-style: none;
  padding: 0;
}

@media (max-width: 600px) {
  .facts-list {
    grid-template-columns: 1fr;
  }
}

.facts-list li {
  font-size: var(--text-base);
  color: var(--color-text);
  padding-bottom: var(--space-2);
  border-bottom: 1px solid var(--color-border);
}

.visa-alert {
  background: rgba(196, 75, 54, 0.1);
  border-left: 4px solid var(--color-accent);
  padding: var(--space-6);
  border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
}

.cities-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-6);
}

@media (max-width: 900px) {
  .cities-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .cities-grid {
    grid-template-columns: 1fr;
  }
}

.city-card {
  position: relative;
  height: 300px;
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: 0 10px 20px rgba(0,0,0,0.1);
}

.city-card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform var(--transition-slow);
}

.city-card:hover img {
  transform: scale(1.05);
}

.city-card__info {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: var(--space-4);
  background: linear-gradient(transparent, rgba(0,0,0,0.8));
  color: white;
}
.city-card__info h3 {
  margin: 0;
  font-size: var(--text-lg);
  text-shadow: 0 2px 4px rgba(0,0,0,0.5);
}
.mt-4 { margin-top: var(--space-4); }
.mt-8 { margin-top: var(--space-8); }
.mt-12 { margin-top: var(--space-12); }
</style>
